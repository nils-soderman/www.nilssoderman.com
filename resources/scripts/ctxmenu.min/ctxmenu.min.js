ECtxMenuNames={menu:"ctx-menu-wrapper",item:"ctx-menu-item",seperator:"ctx-menu-seperator",hasIcon:"ctx-menu-hasIcon"};class CtxMenuManagerClass{constructor(){this._currentMenuVisible=null,this._ctxMenus=new Map,document.addEventListener("contextmenu",this._eventOpenMenu.bind(this));var e=document.getElementsByTagName("script"),t=e[e.length-1].src.split("?")[0].split("/").slice(0,-1).join("/")+"/",n=document.createElement("link");n.href=t+"ctxmenu.min.css",n.type="text/css",n.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(n)}_eventOpenMenu(e){if(null!=e.path)var t=(s=this._traceCtxMenu(e.path))[0],n=s[1];else{var s;t=(s=this._msEdgeTraceCtxMenu(e.target))[0],n=s[1]}0==t?e.preventDefault():1==t?this.closeCurrentlyOpenedMenu():null!=t&&(this.closeCurrentlyOpenedMenu(),t._elementClicked=n,t.openMenu(e.clientX,e.clientY),this._currentMenuVisible=t,document.addEventListener("click",CtxCloseCurrentlyOpenedMenus),window.addEventListener("resize",CtxCloseCurrentlyOpenedMenus),e.preventDefault(),null!=t._openEventListener&&t._openEventListener())}closeMenu(e){e.closeMenu(),this._currentMenuVisible=null,document.removeEventListener("click",CtxCloseCurrentlyOpenedMenus),window.removeEventListener("resize",CtxCloseCurrentlyOpenedMenus)}closeCurrentlyOpenedMenu(){null!=this._currentMenuVisible&&this.closeMenu(this._currentMenuVisible)}_traceCtxMenu(e){for(var t=0;t<e.length;++t){var n=this._ctxMenusHas(e[t]);if(null!=n)return[n,e[t]]}return null}_msEdgeTraceCtxMenu(e){for(;null!=e;){var t=this._ctxMenusHas(e);if(null!=t)return[t,e];e=e.parentNode}return null}_ctxMenusHas(e){if(this._ctxMenus.has(e))return this._ctxMenus.get(e);if(this._ctxMenus.has("#"+e.id))return this._ctxMenus.get("#"+e.id);if(null!=e.className)for(var t=e.className.split(" "),n=0;n<t.length;n++)if(this._ctxMenus.has("."+t[n]))return this._ctxMenus.get("."+t[n]);return this._ctxMenus.has(e.nodeName)?this._ctxMenus.get(e.nodeName):null}getMenuFromElement(e){return this._ctxMenus.get(e)}createNewMenu(e){var t=new CtxMenuClass;return this._ctxMenus.set(e,t),t}setCustomContexMenuValue(e,t){this._ctxMenus.set(e,t)}}class CtxMenuItem{constructor(e,t,n){this.function=t,this.text=e,this.element=document.createElement("div"),this.element.className=ECtxMenuNames.item;var s=document.createElement("img");null!=n&&null!=n?(s.src=n,this.bHasIcon=!0):this.bHasIcon=!1,this.element.appendChild(s),this.element.innerHTML+=this.text}}class CtxMenuClass{constructor(){this.menuContainer=document.createElement("div"),this.menuContainer.className=ECtxMenuNames.menu,document.body.appendChild(this.menuContainer),this.closeMenu(),this._elementClicked=void 0,this._openEventListener=void 0,this._closeEventListener=void 0,this._clickEventListener=void 0}addItem(e,t,n,s){var i=this._createMenuItem(e,t,n);return this.menuContainer.insertBefore(i.element,this.menuContainer.childNodes[s]),i}addSeperator(e){var t=document.createElement("div");t.className=ECtxMenuNames.seperator,this.menuContainer.insertBefore(t,this.menuContainer.childNodes[e])}removeItem(e){this.menuContainer.removeChild(e.element)}addEventListener(e,t){"open"==e?this._openEventListener=t:"close"==e?this._closeEventListener=t:"click"==e&&(this._clickEventListener=t)}openMenu(e,t){this.menuContainer.style.display="block",e+this.menuContainer.offsetWidth>window.innerWidth&&(e=window.innerWidth-this.menuContainer.offsetWidth-1),t+this.menuContainer.offsetHeight>window.innerHeight&&(t=window.innerHeight-this.menuContainer.offsetHeight-1),this.menuContainer.style.left=e+"px",this.menuContainer.style.top=t+"px"}closeMenu(){this.menuContainer.style.left="0px",this.menuContainer.style.top="0px",this.menuContainer.style.display="none",null!=this._closeEventListener&&this._closeEventListener()}_createMenuItem(e,t,n){var s=new CtxMenuItem(e,t,n);return s.element.addEventListener("click",function(){this._callItem(s)}.bind(this)),s.bHasIcon&&this.menuContainer.classList.add(ECtxMenuNames.hasIcon),s}_callItem(e){this.closeMenu(),setTimeout(function(){e.function(this._elementClicked),null!=this._clickEventListener&&this._clickEventListener(e)}.bind(this),1)}}function CtxMenu(e){return null==e&&(e=document),null!=ctxMenuManager.getMenuFromElement(e)?ctxMenuManager.getMenuFromElement(e):ctxMenuManager.createNewMenu(e)}function CtxMenuBlock(e){ctxMenuManager.setCustomContexMenuValue(e,!1)}function CtxMenuDefault(e){ctxMenuManager.setCustomContexMenuValue(e,!0)}function CtxCloseCurrentlyOpenedMenus(){ctxMenuManager.closeCurrentlyOpenedMenu()}var ctxMenuManager=new CtxMenuManagerClass;