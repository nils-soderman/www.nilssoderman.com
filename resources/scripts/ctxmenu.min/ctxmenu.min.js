const ECtxMenuNames={menu:"ctx-menu-wrapper",item:"ctx-menu-item",separator:"ctx-menu-separator",hasIcon:"ctx-menu-hasIcon"};class CtxMenuManagerClass{constructor(){this._currentMenuVisible=null,this._ctxMenus=new Map,document.addEventListener("contextmenu",this._eventOpenMenu.bind(this));const e=document.getElementsByTagName("script"),t=e[e.length-1].src.split("?")[0].split("/").slice(0,-1).join("/")+"/";var n=document.createElement("link");n.href=t+"ctxmenu.min.css",n.type="text/css",n.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(n)}_eventOpenMenu(e){if(null!=e.path)var t=this._traceCtxMenu(e.path);else t=this._msEdgeTraceCtxMenu(e.target);if(this.closeCurrentlyOpenedMenu(),null==t)return;const n=t[0],s=t[1];0!=n?1!=n&&(n._elementClicked=s,n.openMenu(e.pageX,e.pageY),this._currentMenuVisible=n,document.addEventListener("click",CtxCloseCurrentlyOpenedMenus),window.addEventListener("resize",CtxCloseCurrentlyOpenedMenus),e.preventDefault(),null!=n._openEventListener&&n._openEventListener()):e.preventDefault()}closeMenu(e){e.closeMenu(),this._currentMenuVisible=null,document.removeEventListener("click",CtxCloseCurrentlyOpenedMenus),window.removeEventListener("resize",CtxCloseCurrentlyOpenedMenus)}closeCurrentlyOpenedMenu(){null!=this._currentMenuVisible&&this.closeMenu(this._currentMenuVisible)}_traceCtxMenu(e){for(var t=0;t<e.length;++t){const n=this._ctxMenusHas(e[t]);if(null!=n)return[n,e[t]]}return null}_msEdgeTraceCtxMenu(e){for(;null!=e;){const t=this._ctxMenusHas(e);if(null!=t)return[t,e];e=e.parentNode}return null}_ctxMenusHas(e){if(this._ctxMenus.has(e))return this._ctxMenus.get(e);if(this._ctxMenus.has("#"+e.id))return this._ctxMenus.get("#"+e.id);if(null!=e.className){const n=e.className.split(" ");for(var t=0;t<n.length;t++)if(this._ctxMenus.has("."+n[t]))return this._ctxMenus.get("."+n[t])}return this._ctxMenus.has(e.nodeName)?this._ctxMenus.get(e.nodeName):null}getMenuFromElement(e){return this._ctxMenus.get(e)}createNewMenu(e){var t=new CtxMenuClass;return this._ctxMenus.set(e,t),t}setCustomContexMenuValue(e,t){this._ctxMenus.set(e,t)}}class CtxMenuClass{constructor(){this.menuContainer=document.createElement("div"),this.menuContainer.className=ECtxMenuNames.menu,document.body.appendChild(this.menuContainer),this.closeMenu(),this._items=[],this._elementClicked=void 0,this._openEventListener=void 0,this._closeEventListener=void 0,this._clickEventListener=void 0}addItem(e,t,n,s){var i=document.createElement("div");i.className=ECtxMenuNames.item;var u=document.createElement("img");if(null!=n&&null!=n){u.src=n;var r=!0}else r=!1;return i.appendChild(u),i.innerHTML+=e,i.addEventListener("click",function(){this._callItem(t)}.bind(this)),r&&this.menuContainer.classList.add(ECtxMenuNames.hasIcon),this.menuContainer.insertBefore(i,this.menuContainer.childNodes[s]),i}addSeparator(e){var t=document.createElement("div");t.className=ECtxMenuNames.separator,this.menuContainer.insertBefore(t,this.menuContainer.childNodes[e])}removeItem(e){this.menuContainer.removeChild(e.element)}addEventListener(e,t){"open"==e?this._openEventListener=t:"close"==e?this._closeEventListener=t:"click"==e&&(this._clickEventListener=t)}openMenu(e,t){this.menuContainer.style.display="block";const n=document.documentElement.clientWidth+document.documentElement.scrollLeft,s=document.documentElement.clientHeight+document.documentElement.scrollTop;e+this.menuContainer.offsetWidth>n&&(e=n-this.menuContainer.offsetWidth-1),t+this.menuContainer.offsetHeight>s&&(t=s-this.menuContainer.offsetHeight-1),this.menuContainer.style.left=e+"px",this.menuContainer.style.top=t+"px"}closeMenu(){this.menuContainer.style.left="0px",this.menuContainer.style.top="0px",this.menuContainer.style.display="none",null!=this._closeEventListener&&this._closeEventListener()}_callItem(e){this.closeMenu(),setTimeout(function(){e(this._elementClicked),null!=this._clickEventListener&&this._clickEventListener(item)}.bind(this),1)}}function CtxMenu(e){return null==e&&(e=document),null!=ctxMenuManager.getMenuFromElement(e)?ctxMenuManager.getMenuFromElement(e):ctxMenuManager.createNewMenu(e)}function CtxMenuBlock(e){ctxMenuManager.setCustomContexMenuValue(e,!1)}function CtxMenuDefault(e){ctxMenuManager.setCustomContexMenuValue(e,!0)}function CtxCloseCurrentlyOpenedMenus(){ctxMenuManager.closeCurrentlyOpenedMenu()}var ctxMenuManager=new CtxMenuManagerClass;